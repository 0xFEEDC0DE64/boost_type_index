# Copyright (C) 2012 Antony Polukhin
#
# Distributed under the Boost Software License, Version 1.0. (See accompanying
# file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
#

import testing ;
import feature ;

project
    : requirements
        <library>/boost/test//boost_unit_test_framework
        <link>static
    ;

test-suite type_index
  : 
    [ run type_index_test.cpp ]
    [ run template_index_test.cpp ]
    [ run testing_both.cpp ]
    [ run testing_both_no_rtti.cpp : : : <rtti>off ]
    [ run testing_minimal.cpp ]
    [ run testing_minimal_no_rtti.cpp : : : <rtti>off ]
    # Examples that must work even with RTTI disabled
    [ run ../examples/registry.cpp : : : <rtti>off : registry_no_rtti ]
    [ run ../examples/exact_types_match.cpp : : : <rtti>off : exact_types_match_no_rtti ]
    [ run ../examples/demangled_names.cpp : : : <rtti>off : demangled_names_no_rtti ]
    [ compile-fail ../examples/inheritance.cpp : <rtti>off : failing_inheritance_example ]
  ;
  
# Assuring that examples compile and run. Adding sources from `examples` directory to the `type_index` test suite. 
for local p in [ glob ../examples/*.cpp ]
{
    type_index += [ run $(p) ] ;
}
